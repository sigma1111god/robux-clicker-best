<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ROBUX TYCOON: LUNACY SCALING</title>
    <style>
        :root { --main: #a855f7; --bg: #020617; --panel: #0f172a; --accent: #f59e0b; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Courier New', monospace; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; transition: 0.5s; }
        
        #menu { position: fixed; inset: 0; background: var(--bg); z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        #start-btn { padding: 20px 60px; font-size: 24px; background: none; color: var(--main); border: 3px solid var(--main); cursor: pointer; box-shadow: 0 0 30px var(--main); transition: 0.3s; font-weight: bold; }
        #start-btn:hover { background: var(--main); color: white; scale: 1.1; }

        .hud { width: 100%; padding: 20px; background: var(--panel); display: flex; justify-content: space-around; border-bottom: 2px solid #1e293b; }
        .stat-val { font-size: 28px; color: var(--main); font-weight: bold; text-shadow: 0 0 10px var(--main); }
        .label { font-size: 10px; color: #475569; letter-spacing: 2px; }

        .main { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 15px; }
        #coin { width: 160px; height: 160px; background: #1e293b; border: 5px solid var(--main); border-radius: 50%; cursor: pointer; font-size: 60px; display: flex; align-items: center; justify-content: center; transition: 0.1s; box-shadow: 0 0 40px rgba(168, 85, 247, 0.2); position: relative; }
        #coin:active { transform: scale(0.9); box-shadow: 0 0 60px var(--main); }

        .btn-group { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; }
        .btn { padding: 10px 18px; background: #1e293b; color: white; border: 1px solid #334155; cursor: pointer; font-weight: bold; font-size: 11px; }
        .btn-rebirth { border-color: #ef4444; color: #ef4444; transition: 0.3s; }

        .shop { width: 100%; max-width: 550px; background: var(--panel); border-radius: 25px 25px 0 0; padding: 20px; height: 38vh; overflow-y: auto; border: 1px solid #334155; }
        .item { display: flex; align-items: center; background: #020617; padding: 12px; margin-bottom: 8px; border: 1px solid #1e293b; cursor: pointer; transition: 0.2s; }
        .item:hover { border-color: var(--main); transform: translateX(5px); }
        .item.poor { opacity: 0.2; cursor: not-allowed; }
        .item-info { flex: 1; margin-left: 15px; }

        .pop { position: absolute; pointer-events: none; color: white; font-weight: bold; animation: fly 0.8s forwards; text-shadow: 0 0 10px var(--main); }
        @keyframes fly { to { transform: translateY(-120px) scale(1.5); opacity: 0; } }

        /* Prestige Effects */
        .tier-god { box-shadow: inset 0 0 100px rgba(255, 215, 0, 0.2); }
        .tier-god #coin { border-color: #ffd700; color: #ffd700; box-shadow: 0 0 60px #ffd700; }
    </style>
</head>
<body id="body">

    <div id="menu">
        <h1 style="letter-spacing: 15px; font-size: 45px;">LUNACY</h1>
        <p style="color: #475569; margin-bottom: 30px;">[ ULTIMATE PRESTIGE SCALING ]</p>
        <button id="start-btn" onclick="ignite()">START SYSTEM</button>
    </div>

    <audio id="music-track" loop>
        <source src="lunacy (Slowed).mp3" type="audio/mpeg">
    </audio>

    <div class="hud">
        <div class="stat"><span class="label">ROBUX</span><span id="bal" class="stat-val">0</span></div>
        <div class="stat"><span class="label" id="rank-label">RANK: NOOBY</span><span id="rps" class="stat-val">0</span><br><small style="font-size:8px">RPS</small></div>
        <div class="stat"><span class="label">REBIRTHS</span><span id="rebirth-stat" class="stat-val">0/5</span></div>
    </div>

    <div class="main">
        <div id="coin">R$</div>
        <div class="btn-group">
            <button class="btn" onclick="gamble()">ðŸŽ² GAMBLE</button>
            <button class="btn" onclick="redeem()">ðŸ”‘ CODES</button>
            <button class="btn btn-rebirth" id="rebirth-btn" onclick="rebirth()">ðŸŒ€ REBIRTH (2M)</button>
        </div>
    </div>

    <div class="shop" id="shop-list"></div>

    <script>
        const MAX_MONEY = 999999999999999; 
        
        let g = JSON.parse(localStorage.getItem('lunacy_ultimate_v1')) || { 
            money: 0, cpc: 1, rps: 0, rebirths: 0, prestige: 0, items: {} 
        };
        
        const track = document.getElementById('music-track');
        const tiers = ["PRESTIGE NOOBY", "PRESTIGE BETTER", "PRO", "BETTER PRO", "HACKER", "GOD"];

        function ignite() {
            document.getElementById('menu').style.display = 'none';
            track.volume = 0.8;
            track.play().catch(() => console.log("Audio requires interaction"));
        }

        const shopData = [
            { id: 'c1', name: 'Macro Finger', cost: 50, val: 5, type: 'c', icon: 'âš¡' },
            { id: 'c2', name: 'Pro Script', cost: 2500, val: 100, type: 'c', icon: 'ðŸ“œ' },
            { id: 'a1', name: 'Ghost Bot', cost: 20, val: 1, type: 'a', icon: 'ðŸ¤–' },
            { id: 'a2', name: 'Python Dev', cost: 500, val: 20, type: 'a', icon: 'ðŸ’»' },
            { id: 'a3', name: 'Mainframe', cost: 10000, val: 350, type: 'a', icon: 'â˜ï¸' },
            { id: 'a4', name: 'Billionaire', cost: 1000000, val: 60000, type: 'a', icon: 'ðŸ’Ž' }
        ];

        function getRebirthCost() {
            // Cost scales based on rebirth count and prestige tier
            return (2000000 + (g.rebirths * 1000000)) * (g.prestige + 1);
        }

        function getMaxRebirths() {
            return g.prestige === 5 ? 10 : 5; // God tier gets 10, others get 5
        }

        function rebirth() {
            const maxRB = getMaxRebirths();
            const cost = getRebirthCost();

            if (g.money >= cost) {
                if (g.rebirths < maxRB) {
                    // Standard Rebirth
                    g.rebirths++;
                    g.money = 0; g.rps = 0; g.cpc = 1; g.items = {};
                    alert("Rebirth Successful! 2x Power Gained.");
                } else if (g.prestige < 5) {
                    // Prestige Advance
                    if (confirm(`MAX REBIRTHS! Advance to ${tiers[g.prestige + 1]} Tier? (Total Reset)`)) {
                        g.prestige++;
                        g.rebirths = 0;
                        g.money = 0; g.rps = 0; g.cpc = 1; g.items = {};
                    }
                } else {
                    alert("YOU HAVE ATTAINED ULTIMATE DIVINITY.");
                }
                update();
            } else {
                alert(`Need ${cost.toLocaleString()} Robux!`);
            }
        }

        function gamble() {
            if (g.money < 100) return alert("Need 100 R$!");
            let bet = prompt("Bet amount?");
            if (bet > g.money || bet <= 0) return;
            if (Math.random() > 0.5) { 
                g.money = Math.min(MAX_MONEY, g.money + bet*1.5); 
                alert("JACKPOT!"); 
            } else { 
                g.money -= bet*1; 
                alert("BUSTED!"); 
            }
            update();
        }

        function redeem() {
            let code = prompt("Enter Code:").toLowerCase().trim();
            if (code === "lunacy") { g.money += 100000; alert("R$ 100k Added!"); }
            if (code === "godspeed") { g.money += 500000000; alert("DIVINE BOOST: R$ 500M!"); }
            update();
        }

        function buy(id) {
            const item = shopData.find(x => x.id === id);
            const lvl = g.items[id] || 0;
            const cost = Math.ceil(item.cost * Math.pow(1.35, lvl));
            if (g.money >= cost) {
                g.money -= cost;
                g.items[id] = lvl + 1;
                if (item.type === 'c') g.cpc += item.val;
                update();
            }
        }

        function renderShop() {
            const list = document.getElementById('shop-list');
            list.innerHTML = '';
            shopData.forEach(i => {
                const lvl = g.items[i.id] || 0;
                const cost = Math.ceil(i.cost * Math.pow(1.35, lvl));
                list.innerHTML += `
                    <div class="item ${g.money < cost ? 'poor' : ''}" onclick="buy('${i.id}')">
                        <span style="font-size:30px">${i.icon}</span>
                        <div class="item-info"><strong>${i.name} (Lv ${lvl})</strong></div>
                        <div class="item-cost">R$ ${cost.toLocaleString()}</div>
                    </div>`;
            });
        }

        document.getElementById('coin').addEventListener('mousedown', (e) => {
            // Power multiplier: Base * 2^Rebirths * (Prestige+1)
            let gain = g.cpc * Math.pow(2, g.rebirths) * (g.prestige + 1);
            g.money = Math.min(MAX_MONEY, g.money + gain);
            
            const p = document.createElement('div');
            p.className = 'pop'; p.innerText = "+" + Math.floor(gain);
            p.style.left = e.clientX + 'px'; p.style.top = e.clientY + 'px';
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 800);
            update();
        });

        function update() {
            g.rps = shopData.filter(x => x.type === 'a').reduce((s, x) => s + (g.items[x.id] || 0) * x.val, 0) * (g.prestige + 1);
            
            const maxRB = getMaxRebirths();
            const cost = getRebirthCost();
            
            document.getElementById('bal').innerText = Math.floor(g.money).toLocaleString();
            document.getElementById('rps').innerText = Math.floor(g.rps).toLocaleString();
            document.getElementById('rebirth-stat').innerText = `${g.rebirths}/${maxRB}`;
            document.getElementById('rank-label').innerText = "RANK: " + tiers[g.prestige];
            
            const rbBtn = document.getElementById('rebirth-btn');
            if (g.rebirths >= maxRB && g.prestige < 5) {
                rbBtn.innerText = `â­ PRESTIGE TO ${tiers[g.prestige+1]}`;
                rbBtn.style.boxShadow = "0 0 30px #00ffcc";
                rbBtn.style.color = "#00ffcc";
            } else if (g.rebirths >= maxRB && g.prestige === 5) {
                rbBtn.innerText = "MAX DIVINITY";
            } else {
                rbBtn.innerText = `ðŸŒ€ REBIRTH (${(cost/1000000).toFixed(1)}M)`;
                rbBtn.style.boxShadow = g.money >= cost ? "0 0 20px #ef4444" : "none";
                rbBtn.style.color = "#ef4444";
            }

            // Visual Scaling
            if (g.prestige === 5) document.getElementById('body').classList.add('tier-god');

            localStorage.setItem('lunacy_ultimate_v1', JSON.stringify(g));
            renderShop();
        }

        setInterval(() => { g.money = Math.min(MAX_MONEY, g.money + (g.rps / 10)); update(); }, 100);
        update();
    </script>
</body>
</html>